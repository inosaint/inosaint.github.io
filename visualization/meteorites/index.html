<!DOCTYPE html>
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="css/dviz.css" />
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
    <script type="text/javascript" src="http://d3js.org/d3.v2.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.8.3.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/jquery.tipsy.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">google.load('visualization', '1.0', {'packages': ['corechart', 'table']});</script>
    <script type="text/javascript" src="js/dviz.js"></script>
    <script type="text/javascript">$(function() {dviz.run();});</script>
    <script src='wax/ext/modestmaps.min.js' type='text/javascript'></script>
    <script src='wax/dist/wax.mm.js' type='text/javascript'></script>
    <script type="text/javascript" src="js/scatter.js"></script>
    <link href='wax/theme/controls.css' rel='stylesheet' type='text/css' />

    <link rel="stylesheet" href="css/foundation.min.css">
    <link rel="stylesheet" href="css/common.css">
       
    <title>Meteorites: Earth Impact</title>
</head>
<body>

<script type="text/javascript">
var url = 'http://a.tiles.mapbox.com/v3/kenneth.meteorites.jsonp';
wax.tilejson(url, function(tilejson) {
    // Set up a map in a div with the id 'modestmaps-setup'
    var m = new MM.Map('modestmaps-setup',
      // Use Wax's connector to add a new custom layer
      new wax.mm.connector(tilejson)
      ,new MM.Point(940,550)
      );
  
    // Adding zoom controls
    wax.mm.zoomer(m, tilejson).appendTo(m.parent);
    // Center it on the World center
    m.setCenterZoom({ lat: 0, lon: 0 }, 2);
    //tooltips
    wax.mm.interaction().map(m).tilejson(tilejson).on(wax.movetip().parent(m.parent).events());

    //legend
    wax.mm.legend(m, tilejson).appendTo(m.parent);
});
</script>

<div class="row">
    <h1>Meteorites: Earth Impact</h1>
    <p><strong>'Meteorites: Earth Impact'</strong> is an attempt to visualize meteorites that have impacted earth in the past. The Meteoritical Society has a massive database of all the recorded meteorites that have collided with Earth dating as far back as 2500 BCE, providing the most comprehensive public picture of known meteorite collisions. This visualization is my first attempt at an interactive visualization and was built for the 'Visualizing Meteorites' contest held by Visualizing.org in the month of May 2013.</p>
    <p>Dataset: <a href="http://visualizing.org/datasets/meteorite-landings">Meteorite landings(Visualizing.org)</a></p>
</div>

<div class="row">
<div id="modestmaps-setup"></div>
</div>

<div class="row">
    <br>
    <p>
    A <strong>meteorite</strong> is a meteoroid (a solid piece of debris from such sources as asteroids or comets) originating in outer space that survives impact with the Earth's surface.  Meteorite falls are those meteorites that are collected soon after being witnessed to fall, whereas meteorite finds are discovered at a later time. Although there are 30x more finds than falls, their raw distribution of types does not accurately reflect what falls to Earth <a href="http://en.wikipedia.org/wiki/Meteorite_fall_statistics">for various reasons</a>.
    </p>
</div>

<div class="dviz-content">
<div class="row"> 
<h5>Meteorites seen falling:</h5>
<pre><code>
Year,Falls
-2500,0
-600,0
-300,0
861,1
921,1
1400,1
1491,1
1492,1
1496,1
1520,1
1576,0
1583,1
1600,0
1621,1
1623,1
1628,1
1632,1
1636,1
1637,1
1647,1
1654,1
1662,1
1668,1
1671,1
1688,1
1704,1
1715,1
1716,0
1723,1
1724,0
1740,1
1741,1
1749,0
1750,1
1751,1
1753,2
1766,1
1768,2
1769,1
1773,1
1775,2
1776,0
1779,1
1781,0
1784,0
1785,1
1787,1
1790,1
1791,1
1792,0
1793,0
1794,1
1795,2
1796,2
1797,0
1798,2
1801,1
1803,3
1804,3
1805,2
1806,1
1807,2
1808,4
1809,1
1810,3
1811,3
1812,4
1813,2
1814,4
1815,2
1817,1
1818,3
1819,2
1820,1
1821,1
1822,6
1823,2
1824,3
1825,2
1826,3
1827,3
1828,1
1829,3
1830,2
1831,2
1832,0
1833,1
1834,2
1835,2
1836,3
1837,3
1838,5
1839,1
1840,3
1841,3
1842,4
1843,6
1844,3
1845,2
1846,3
1847,2
1848,4
1849,1
1850,2
1851,3
1852,4
1853,3
1854,1
1855,6
1856,2
1857,7
1858,4
1859,4
1860,6
1861,4
1862,2
1863,6
1864,3
1865,7
1866,7
1867,3
1868,11
1869,7
1870,3
1871,4
1872,4
1873,5
1874,3
1875,6
1876,5
1877,7
1878,6
1879,8
1880,7
1881,4
1882,4
1883,3
1884,3
1885,2
1886,7
1887,5
1888,0
1889,5
1890,9
1891,2
1892,4
1893,4
1894,4
1895,4
1896,4
1897,8
1898,5
1899,7
1900,8
1901,5
1902,7
1903,8
1904,4
1905,5
1906,7
1907,4
1908,6
1909,2
1910,11
1911,5
1912,4
1913,4
1914,7
1915,2
1916,10
1917,10
1918,6
1919,7
1920,5
1921,8
1922,6
1923,6
1924,10
1925,9
1926,7
1927,6
1928,6
1929,7
1930,11
1931,6
1932,8
1933,17
1934,10
1935,6
1936,5
1937,7
1938,11
1939,10
1940,5
1941,4
1942,8
1943,3
1944,7
1945,4
1946,5
1947,6
1948,3
1949,13
1950,12
1951,7
1952,6
1953,3
1954,6
1955,4
1956,8
1957,6
1958,2
1959,6
1960,5
1961,7
1962,7
1963,7
1964,7
1965,4
1966,5
1967,9
1968,5
1969,6
1970,8
1971,7
1972,3
1973,4
1974,7
1975,4
1976,12
1977,10
1978,3
1979,2
1980,6
1981,7
1982,3
1983,5
1984,10
1985,2
1986,9
1987,1
1988,6
1989,7
1990,8
1991,5
1992,3
1993,4
1994,6
1995,6
1996,5
1997,3
1998,9
1999,7
2000,4
2001,5
2002,8
2003,9
2004,6
2005,0
2006,5
2007,8
2008,9
2009,5
2010,6
2011,4
2012,2
2013,1
</code></pre>
<p><code>(@column {colors:['#f1c40f'],height:300,vAxis:{title: 'Number'},hAxis:{title: 'Years'}})</code></p>
</div>

<div class="row">
<h5>Meteorites found:</h5>
<pre>
   <code>
Year,Finds
-2500,1
-600,1
-300,1
861,0
921,0
1400,0
1491,0
1492,0
1496,0
1520,0
1576,1
1583,0
1600,1
1621,0
1623,0
1628,0
1632,0
1636,0
1637,0
1647,0
1654,0
1662,0
1668,0
1671,0
1688,0
1704,0
1715,0
1716,1
1723,0
1724,1
1740,0
1741,0
1749,1
1750,0
1751,0
1753,0
1766,0
1768,0
1769,0
1773,0
1775,0
1776,1
1779,0
1781,1
1784,2
1785,0
1787,0
1790,0
1791,0
1792,1
1793,1
1794,0
1795,0
1796,0
1797,1
1798,0
1801,0
1803,0
1804,3
1805,1
1806,0
1807,0
1808,1
1809,0
1810,2
1811,0
1812,0
1813,0
1814,1
1815,0
1817,0
1818,2
1819,1
1820,0
1821,0
1822,2
1823,0
1824,0
1825,1
1826,0
1827,0
1828,1
1829,1
1830,0
1831,0
1832,1
1833,0
1834,1
1835,0
1836,2
1837,2
1838,2
1839,4
1840,4
1841,1
1842,1
1843,1
1844,1
1845,1
1846,4
1847,3
1848,0
1849,2
1850,6
1851,0
1852,4
1853,2
1854,8
1855,3
1856,4
1857,3
1858,4
1859,1
1860,5
1861,2
1862,1
1863,9
1864,1
1865,1
1866,5
1867,5
1868,5
1869,5
1870,3
1871,3
1872,2
1873,5
1874,3
1875,7
1876,4
1877,2
1878,3
1879,6
1880,8
1881,6
1882,5
1883,7
1884,8
1885,5
1886,3
1887,16
1888,15
1889,10
1890,11
1891,8
1892,7
1893,8
1894,6
1895,6
1896,6
1897,4
1898,12
1899,7
1900,9
1901,5
1902,5
1903,14
1904,7
1905,9
1906,6
1907,12
1908,7
1909,9
1910,9
1911,7
1912,8
1913,7
1914,11
1915,11
1916,10
1917,9
1918,9
1919,7
1920,9
1921,10
1922,9
1923,10
1924,8
1925,9
1926,6
1927,10
1928,10
1929,8
1930,9
1931,16
1932,17
1933,13
1934,17
1935,13
1936,30
1937,47
1938,34
1939,22
1940,32
1941,19
1942,12
1943,7
1944,13
1945,7
1946,8
1947,13
1948,17
1949,10
1950,28
1951,13
1952,12
1953,6
1954,16
1955,20
1956,19
1957,12
1958,16
1959,10
1960,25
1961,20
1962,29
1963,27
1964,26
1965,46
1966,21
1967,28
1968,49
1969,64
1970,39
1971,42
1972,29
1973,27
1974,684
1975,333
1976,40
1977,411
1978,259
1979,3044
1980,146
1981,456
1982,341
1983,355
1984,392
1985,376
1986,1366
1987,915
1988,2290
1989,129
1990,1510
1991,872
1992,369
1993,975
1994,713
1995,481
1996,578
1997,1693
1998,2688
1999,1684
2000,1788
2001,1645
2002,2070
2003,3314
2004,1934
2005,875
2006,2451
2007,1181
2008,948
2009,1492
2010,999
2011,709
2012,232
2013,10
   </code>
</pre>
<p><code>(@column {colors:['#c0392b'],height:300,vAxis:{title: 'Number'},hAxis:{title: 'Years'}})</code></p>
</div>
</div>

<div class="row">
  <div class="twelve columns">
    <p>Till date, 45,716 meteors have been recorded to have hit earth. Of which only 1,107 have been seen falling. From the map above you notice that some countries seem to have more than their share of meteorites and you may have to look up so that you wont get hit by one ;)</p>
    <h5>Meteorite Count per Country vs Meteorite Mass</h5>
  </div>
  <div class="twelve columns">
    <div id="chart">
        <script type="text/javascript">
        //code which draws the scatterplot of number of meteorites vs mass per country

      // set the stage
        var margin = {t:30, r:20, b:20, l:40 },
          w = 940 - margin.l - margin.r,
          h = 500 - margin.t - margin.b,
          x = d3.scale.log().domain([0.4, 90800.88732]).range([0, w]),
          y = d3.scale.log().domain([1, 3200]).range([h - 60, 0]),
          //colors that will reflect geographical regions
          color = d3.scale.category20(),
          cr= d3.scale.sqrt().domain([4, 180]).range([1, 25]);

        var svg = d3.select("#chart").append("svg")
          .attr("width", w + margin.l + margin.r)
          .attr("height", h + margin.t + margin.b);

        // set axes, as well as details on their ticks
        var xAxis = d3.svg.axis()
          .scale(x)
          .ticks(15)
          .tickSubdivide(true)
          .tickSize(6, 3, 0)
          .orient("bottom");

        var yAxis = d3.svg.axis()
          .scale(y)
          .ticks(15)
          .tickSubdivide(true)
          .tickSize(6, 3, 0)
          .orient("left");

        // group that will contain all of the plots
        var groups = svg.append("g").attr("transform", "translate(" + margin.l + "," + margin.t + ")");

        // array of the regions, used for the legend
        var regions = ["Asia", "Europe", "Oceania","N. America", "S. America", "Africa"]


      // bring in the data, and do everything that is data-driven
      d3.csv("data/scatterlistclean.csv", function(data) {

        // sort data alphabetically by region, so that the colors match with legend
        data.sort(function(a, b) { return d3.ascending(a.region, b.region); })
        //console.log(data)

        var x0 = Math.max(-d3.min(data, function(d) { return d.mass; }), d3.max(data, function(d) { return d.mass; }));


        // style the circles, set their locations based on data
        var circles =
        groups.selectAll("circle")
          .data(data)
          .enter().append("circle")
          .attr("class", "circles")
          .attr({
            cx: function(d) { return x(+d.mass); },
            cy: function(d) { return y(+d.number); },
            //r: function(d) { return cr(+d.mass); },
            r: 8,
            id: function(d) { return d.country; }
          })
          .style("fill", function(d) { return color(d.region); });

        // what to do when we mouse over a bubble
        var mouseOn = function() { 
          var circle = d3.select(this);

        // transition to increase size/opacity of bubble
          circle.transition()
          .duration(800).style("opacity", 1)
          .ease("elastic");

          // append lines to bubbles that will be used to show the precise data points.
          // translate their location based on margins
          svg.append("g")
            .attr("class", "guide")
          .append("line")
            .attr("x1", circle.attr("cx"))
            .attr("x2", circle.attr("cx"))
            .attr("y1", +circle.attr("cy") + 26)
            .attr("y2", h - margin.t - margin.b)
            .attr("transform", "translate(40,20)")
            .style("stroke", circle.style("fill"))
            .transition().delay(200).duration(400).styleTween("opacity", 
                  function() { return d3.interpolate(0, .5); })

          svg.append("g")
            .attr("class", "guide")
          .append("line")
            .attr("x1", +circle.attr("cx") - 16)
            .attr("x2", 0)
            .attr("y1", circle.attr("cy"))
            .attr("y2", circle.attr("cy"))
            .attr("transform", "translate(40,30)")
            .style("stroke", circle.style("fill"))
            .transition().delay(200).duration(400).styleTween("opacity", 
                  function() { return d3.interpolate(0, .5); });

        // function to move mouseover item to front of SVG stage, in case
        // another bubble overlaps it
          d3.selection.prototype.moveToFront = function() { 
            return this.each(function() { 
            this.parentNode.appendChild(this); 
            }); 
          };

        // skip this functionality for IE9, which doesn't like it
          if (!$.browser.msie) {
            circle.moveToFront(); 
            }
        };
        // what happens when we leave a bubble?
        var mouseOff = function() {
          var circle = d3.select(this);

          // go back to original size and opacity
          circle.transition()
          .duration(800).style("opacity", .5)
          .ease("elastic");

          // fade out guide lines, then remove them
          d3.selectAll(".guide").transition().duration(100).styleTween("opacity", 
                  function() { return d3.interpolate(.5, 0); })
            .remove()
        };

        // run the mouseon/out functions
        circles.on("mouseover", mouseOn);
        circles.on("mouseout", mouseOff);

        // tooltips (using jQuery plugin tipsy)
        circles.append("title")
            .text(function(d) { return d.country+"("+d.mass+","+d.number+")"; })

        $(".circles").tipsy({ gravity: 's', });

        // the legend color guide
        var legend = svg.selectAll("rect")
            .data(regions)
          .enter().append("rect")
          .attr({
            x: function(d, i) { return (40 + i*80); },
            y: h,
            width: 25,
            height: 12
          })
          .style("fill", function(d) { return color(d); });


        // legend labels  
          svg.selectAll("text")
            .data(regions)
          .enter().append("text")
          .attr({
          x: function(d, i) { return (40 + i*80); },
          y: h + 24,
          })
          .text(function(d) { return d; });

        // draw axes and axis labels
        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(" + margin.l + "," + (h - 60 + margin.t) + ")")
          .call(xAxis);

        svg.append("g")
          .attr("class", "y axis")
          .attr("transform", "translate(" + margin.l + "," + margin.t + ")")
          .call(yAxis);

        svg.append("text")
          .attr("class", "x label")
          .attr("text-anchor", "end")
          .attr("x", w + 50)
          .attr("y", h - margin.t - 5)
          .text("Meteorite Mass(in kgs)");

        svg.append("text")
          .attr("class", "y label")
          .attr("text-anchor", "end")
          .attr("x", -20)
          .attr("y", 45)
          .attr("dy", ".75em")
          .attr("transform", "rotate(-90)")
          .text("Number of Meteorites");
        });
      </script>
    </div>
  </div>
  <div class="twelve columns">
    <p><em>Footnote: The scatterplot contains only data that had coordinates. Quite a bit of the original dataset did not have coordinates or had bad coordinates. Also I had to leave out Antarctica out of the scatterplot because it was skewing the data.</em></p>
    <hr>
  </div>
</div>


<footer>
<div class="row">
    
    
    <div class="five columns">
        
        <strong>Credits:</strong>
        <p>Visualized by <a href="https://twitter.com/kenneth">Kenneth Mark Dsouza</a>.<br> <a href="https://twitter.com/HashNuke">Akash</a> helped me crunch some data and get git set up.<br> <a href="https://twitter.com/sevenaces">Parag</a> helped me when I got stuck with MS Excel.</p>
        
        
    </div>


    <div class="seven columns" style="border-left:1px solid #ddd;padding-top:7px">
        <div class="right">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br><p><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/InteractiveResource" property="dct:title" rel="dct:type">'Meteorites: Earth Impact'</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://kenneth.dsouza.im" property="cc:attributionName" rel="cc:attributionURL">Kenneth Mark Dsouza</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.</p>
        </div>
    </div>

    <div class="twelve columns">
    <hr>
        <div class="twelve columns">
        <ul class="inline-list right">
            <li><a href="#" alt="yet to be added">Colophon</a></li>
            <li><a href="http://aninosaintlife.wordpress.com/">Blog</a></li>
        </ul>
        </div>
    </div>
</div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41378570-1', 'inosaint.github.io');
  ga('send', 'pageview');

</script>
</body>
</html>
