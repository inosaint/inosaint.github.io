---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

// Get all writing posts and sort by date (newest first)
const allWritings = await getCollection('writing');
const sortedWritings = allWritings.sort((a, b) => {
  return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
});

// Get the 2 most recent posts for the home page
const recentWritings = sortedWritings.slice(0, 2);

// Get all projects
const projects = await getCollection('projects');
---

<BaseLayout>
  <!-- Intro Section -->
  <section class="intro">
    <div class="intro-text">
      <h1>Kenneth Mark Dsouza</h1>
      <h3>
        Product Design Manager with experience building and leading design teams in South East Asia and India
      </h3>
      <p>
        Recently, I was a senior design manager at <a href="https://www.jiva.ag" target="_blank" rel="noopener noreferrer">Jiva</a> (2022-2025), an Agritech startup, where I built and led the product design and research team, working on a suite of mobile apps and web apps for users in rural Indonesia. You can read about the work we did in our Medium publication, <a href="https://medium.com/notes-from-the-fields" target="_blank" rel="noopener noreferrer">Notes from the Fields</a>.
      </p>
      <p>
        Prior to this, I worked at <a href="https://www.gojek.com/en-id/" target="_blank" rel="noopener noreferrer">Gojek</a> managing a team of designers on the Merchant Platform aka <a href="https://gobiz.co.id/" target="_blank" rel="noopener noreferrer">GoBiz</a> and at <a href="https://www.practo.com/providers" target="_blank" rel="noopener noreferrer">Practo</a>, an Indian healthcare startup, working on their doctor facing products like <a href="https://www.practo.com/practo-pro-app" target="_blank" rel="noopener noreferrer">Practo Pro</a>.
      </p>
    </div>
    <div>
      <img
        src="/profile.png"
        alt="Kenneth Mark Dsouza"
        class="profile-photo"
      />
    </div>
  </section>

  <!-- Projects Section -->
  <section>
    <div class="section-header">
      <h4>Projects</h4>
      <a href="/projects" class="view-all">view all projects →</a>
    </div>
    <div class="grid">
      {projects.map(project => (
        <a href={`/projects/${project.slug}`} class="card">
          {project.data.image ? (
            <Image
              src={project.data.image}
              alt={project.data.title}
              class="card-image"
              width={360}
              height={200}
            />
          ) : (
            <img
              src="https://placehold.co/360x200"
              alt={project.data.title}
              class="card-image"
            />
          )}
          <h3>{project.data.title}</h3>
          <p>{project.data.description}</p>
        </a>
      ))}
    </div>
  </section>

  <!-- Writing and Talks Section -->
  <section>
    <div class="section-header">
      <h4>Writing and Talks</h4>
      <a href="/writing" class="view-all">view all writings →</a>
    </div>
    <div class="grid">
      {recentWritings.map(writing => (
        <a href={`/writing/${writing.slug}/`} class="card">
          {writing.data.image ? (
            <Image
              src={writing.data.image}
              alt={writing.data.title}
              class="card-image"
              width={360}
              height={200}
            />
          ) : (
            <img
              src="https://placehold.co/360x200"
              alt={writing.data.title}
              class="card-image"
            />
          )}
          <h3>{writing.data.title}</h3>
          <p>{writing.data.description}</p>
        </a>
      ))}
    </div>
  </section>
</BaseLayout>
